<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="mappers.gsh-review-mapper">
	
	<!-- 	전체 영화 리스트 가져오기 -->
	<select id="select_review_num">
		select * from tbl_review
		order by review_num desc
	</select>
	
		<!-- 영화 리뷰 정보 찾기  -->
	<select id="selectMovieCode" resultType="GshMovieDto">
		select *
		from tbl_movie m, tbl_review r
		where m.movie_code = r.movie_code
		order by review_num desc
	</select>
	
	<!-- 리뷰 작성하기 -->
	<insert id="write_review">
		insert into tbl_review(review_num, movie_code, user_id, review_content, review_score)
		values(seq_review_num.nextval, #{movie_code}, #{user_id}, #{review_content}, #{review_score})
	</insert>
	
	<!-- 리뷰 삭제하기 -->
	<delete id="delete_review">
		delete from tbl_review
		where review_num = #{review_num};
	</delete>
	
	<!-- 2020/07/23 추가 -->
	<!-- 리뷰 수정하기(리뷰 내용, 리뷰 평점) -->
	<update id="update_review">
		update tbl_review
		set review_content = #{review_content}, #{review_score}
		where review_num = #{review_num}
	</update>
	
	<!-- 2020/07/22 추가 -->
	<!-- 작성자 아이디로 리뷰 찾기 -->
	<select id="search_review">
		select * from tbl_review
		where user_id = #{user_id}
	</select>
	
	<!-- 2020/07/23 변경 -->
	<!-- 해당 영화 리뷰 찾기 -->
	<select id="selectReviewByCode" resultType="GshReviewVo">
		select * from tbl_review
		where movie_code = #{movie_code}
		order by review_num desc
	</select>
		
</mapper>